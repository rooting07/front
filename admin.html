<!DOCTYPE html>
<html>
<head>
<title>2wbit | Admin</title>
<style>
body{background:#0b0f14;color:white;font-family:Arial}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #333;padding:10px;text-align:center}
th{background:#111}
button{background:#00ffcc;border:none;padding:5px 10px}
</style>
</head>
<body>

<h2>لوحة الأدمن</h2>
<table id="users">
<tr>
<th>ID</th><th>Email</th><th>Balance</th><th>+</th>
</tr>
</table>

<script>
const user = JSON.parse(localStorage.getItem("user"));
if(!user || user.role!=="admin"){
  alert("دخول مرفوض");
  location.href="login.html";
}

fetch("http://localhost:3000/api/admin/users")
.then(r=>r.json())
.then(data=>{
  const table = document.getElementById("users");
  data.forEach(u=>{
    table.innerHTML += `
    <tr>
      <td>${u.id}</td>
      <td>${u.email}</td>
      <td>${u.balance}</td>
      <td><button onclick="add(${u.id})">+10</button></td>
    </tr>`;
  });
});

function add(id){
  fetch("http://localhost:3000/api/admin/add-balance",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({userId:id,amount:10})
  }).then(()=>location.reload());
}
</script>

</body>
</html>